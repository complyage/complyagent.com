package publish

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import (
	"fmt"
	"time"

	"github.com/complyage/base/verify"
)

//||------------------------------------------------------------------------------------------------||
//|| Starts the ID verification process
//||------------------------------------------------------------------------------------------------||

func AgentVerifyIDStart(v verify.Verification) error {

	fmt.Println("AgentVerifyIDStart: Starting ID verification process for UUID:", v.UUID)
	//||------------------------------------------------------------------------------------------------||
	//|| Create the Agent Request
	//||------------------------------------------------------------------------------------------------||

	request := AgentVerification{
		Level:      1,
		Process:    ProcessVerifyID,
		Identifier: v.UUID,
		Timestamp:  time.Now().UTC().Format(time.RFC3339),
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Send the request to RabbitMQ
	//||------------------------------------------------------------------------------------------------||

	pubErr := PublishAgentVerification(request)
	if pubErr != nil {
		return pubErr
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Success
	//||------------------------------------------------------------------------------------------------||

	return nil
}
